# sample run
$SPARK_HOME/bin/spark-submit all_versus_all_correlation_dataframe.py sample_input.txt

input_path =  sample_input.txt
df.count() =  112
+-------+----------+---------------+
|gene_id|patient_id|biomarker_value|
+-------+----------+---------------+
|g1     |p1        |1.0            |
|g1     |p1        |1.1            |
|g1     |p1        |1.2            |
|g1     |p1        |1.3            |
|g1     |p1        |0.2            |
|g1     |p1        |1.3            |
|g1     |p2        |0.8            |
|g1     |p2        |1.1            |
|g1     |p2        |1.5            |
|g1     |p2        |1.3            |
|g1     |p2        |1.1            |
|g1     |p2        |0.7            |
|g1     |p3        |1.0            |
|g1     |p3        |1.4            |
|g1     |p3        |1.6            |
|g1     |p3        |2.3            |
|g1     |p3        |2.0            |
|g1     |p3        |1.3            |
|g1     |p3        |2.0            |
|g1     |p3        |3.3            |
+-------+----------+---------------+
only showing top 20 rows

root
 |-- gene_id: string (nullable = true)
 |-- patient_id: string (nullable = true)
 |-- biomarker_value: double (nullable = true)

grouped_by_gene_id.count() =  4
+-------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|gene_id|values                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+-------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|g4     |[{p1, 1.2}, {p1, 1.3}, {p1, 1.0}, {p1, 1.2}, {p1, 2.6}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.4}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.6}, {p2, 3.3}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p3, 1.0}, {p3, 0.8}, {p3, 0.3}]|
|g2     |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 0.6}, {p2, 0.1}, {p2, 0.5}, {p2, 3.0}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                                                                                           |
|g3     |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                         |
|g1     |[{p1, 1.0}, {p1, 1.1}, {p1, 1.2}, {p1, 1.3}, {p1, 0.2}, {p1, 1.3}, {p2, 0.8}, {p2, 1.1}, {p2, 1.5}, {p2, 1.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.0}, {p3, 1.4}, {p3, 1.6}, {p3, 2.3}, {p3, 2.0}, {p3, 1.3}, {p3, 2.0}, {p3, 3.3}]                                                                                                                                                                                                                            |
+-------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

root
 |-- gene_id: string (nullable = true)
 |-- values: array (nullable = false)
 |    |-- element: struct (containsNull = false)
 |    |    |-- patient_id: string (nullable = true)
 |    |    |-- biomarker_value: double (nullable = true)

cart =  DataFrame[gene_id: string, values: array<struct<patient_id:string,biomarker_value:double>>, gene_id_2: string, values_2: array<struct<patient_id:string,biomarker_value:double>>]
cart.count() =  16
+-------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|gene_id|values                                                                                                                                                                                                                                                                                                                                                                                                                                                  |gene_id_2|values_2                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|g4     |[{p1, 1.2}, {p1, 1.3}, {p1, 1.0}, {p1, 1.2}, {p1, 2.6}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.4}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.6}, {p2, 3.3}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p3, 1.0}, {p3, 0.8}, {p3, 0.3}]|g4       |[{p1, 1.2}, {p1, 1.3}, {p1, 1.0}, {p1, 1.2}, {p1, 2.6}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.4}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.6}, {p2, 3.3}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p3, 1.0}, {p3, 0.8}, {p3, 0.3}]|
|g4     |[{p1, 1.2}, {p1, 1.3}, {p1, 1.0}, {p1, 1.2}, {p1, 2.6}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.4}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.6}, {p2, 3.3}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p3, 1.0}, {p3, 0.8}, {p3, 0.3}]|g2       |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 0.6}, {p2, 0.1}, {p2, 0.5}, {p2, 3.0}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                                                                                           |
|g4     |[{p1, 1.2}, {p1, 1.3}, {p1, 1.0}, {p1, 1.2}, {p1, 2.6}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.4}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.6}, {p2, 3.3}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p3, 1.0}, {p3, 0.8}, {p3, 0.3}]|g3       |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                         |
|g4     |[{p1, 1.2}, {p1, 1.3}, {p1, 1.0}, {p1, 1.2}, {p1, 2.6}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.4}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.6}, {p2, 3.3}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p3, 1.0}, {p3, 0.8}, {p3, 0.3}]|g1       |[{p1, 1.0}, {p1, 1.1}, {p1, 1.2}, {p1, 1.3}, {p1, 0.2}, {p1, 1.3}, {p2, 0.8}, {p2, 1.1}, {p2, 1.5}, {p2, 1.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.0}, {p3, 1.4}, {p3, 1.6}, {p3, 2.3}, {p3, 2.0}, {p3, 1.3}, {p3, 2.0}, {p3, 3.3}]                                                                                                                                                                                                                            |
|g2     |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 0.6}, {p2, 0.1}, {p2, 0.5}, {p2, 3.0}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                                                                                           |g4       |[{p1, 1.2}, {p1, 1.3}, {p1, 1.0}, {p1, 1.2}, {p1, 2.6}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.4}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.6}, {p2, 3.3}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p3, 1.0}, {p3, 0.8}, {p3, 0.3}]|
|g2     |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 0.6}, {p2, 0.1}, {p2, 0.5}, {p2, 3.0}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                                                                                           |g2       |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 0.6}, {p2, 0.1}, {p2, 0.5}, {p2, 3.0}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                                                                                           |
|g2     |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 0.6}, {p2, 0.1}, {p2, 0.5}, {p2, 3.0}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                                                                                           |g3       |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                         |
|g2     |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 0.6}, {p2, 0.1}, {p2, 0.5}, {p2, 3.0}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                                                                                           |g1       |[{p1, 1.0}, {p1, 1.1}, {p1, 1.2}, {p1, 1.3}, {p1, 0.2}, {p1, 1.3}, {p2, 0.8}, {p2, 1.1}, {p2, 1.5}, {p2, 1.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.0}, {p3, 1.4}, {p3, 1.6}, {p3, 2.3}, {p3, 2.0}, {p3, 1.3}, {p3, 2.0}, {p3, 3.3}]                                                                                                                                                                                                                            |
|g3     |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                         |g4       |[{p1, 1.2}, {p1, 1.3}, {p1, 1.0}, {p1, 1.2}, {p1, 2.6}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.4}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.6}, {p2, 3.3}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p3, 1.0}, {p3, 0.8}, {p3, 0.3}]|
|g3     |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                         |g2       |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 0.6}, {p2, 0.1}, {p2, 0.5}, {p2, 3.0}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                                                                                           |
|g3     |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                         |g3       |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                         |
|g3     |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                         |g1       |[{p1, 1.0}, {p1, 1.1}, {p1, 1.2}, {p1, 1.3}, {p1, 0.2}, {p1, 1.3}, {p2, 0.8}, {p2, 1.1}, {p2, 1.5}, {p2, 1.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.0}, {p3, 1.4}, {p3, 1.6}, {p3, 2.3}, {p3, 2.0}, {p3, 1.3}, {p3, 2.0}, {p3, 3.3}]                                                                                                                                                                                                                            |
|g1     |[{p1, 1.0}, {p1, 1.1}, {p1, 1.2}, {p1, 1.3}, {p1, 0.2}, {p1, 1.3}, {p2, 0.8}, {p2, 1.1}, {p2, 1.5}, {p2, 1.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.0}, {p3, 1.4}, {p3, 1.6}, {p3, 2.3}, {p3, 2.0}, {p3, 1.3}, {p3, 2.0}, {p3, 3.3}]                                                                                                                                                                                                                            |g4       |[{p1, 1.2}, {p1, 1.3}, {p1, 1.0}, {p1, 1.2}, {p1, 2.6}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.4}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.6}, {p2, 3.3}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p3, 1.0}, {p3, 0.8}, {p3, 0.3}]|
|g1     |[{p1, 1.0}, {p1, 1.1}, {p1, 1.2}, {p1, 1.3}, {p1, 0.2}, {p1, 1.3}, {p2, 0.8}, {p2, 1.1}, {p2, 1.5}, {p2, 1.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.0}, {p3, 1.4}, {p3, 1.6}, {p3, 2.3}, {p3, 2.0}, {p3, 1.3}, {p3, 2.0}, {p3, 3.3}]                                                                                                                                                                                                                            |g2       |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 0.6}, {p2, 0.1}, {p2, 0.5}, {p2, 3.0}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                                                                                           |
|g1     |[{p1, 1.0}, {p1, 1.1}, {p1, 1.2}, {p1, 1.3}, {p1, 0.2}, {p1, 1.3}, {p2, 0.8}, {p2, 1.1}, {p2, 1.5}, {p2, 1.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.0}, {p3, 1.4}, {p3, 1.6}, {p3, 2.3}, {p3, 2.0}, {p3, 1.3}, {p3, 2.0}, {p3, 3.3}]                                                                                                                                                                                                                            |g3       |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                         |
|g1     |[{p1, 1.0}, {p1, 1.1}, {p1, 1.2}, {p1, 1.3}, {p1, 0.2}, {p1, 1.3}, {p2, 0.8}, {p2, 1.1}, {p2, 1.5}, {p2, 1.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.0}, {p3, 1.4}, {p3, 1.6}, {p3, 2.3}, {p3, 2.0}, {p3, 1.3}, {p3, 2.0}, {p3, 3.3}]                                                                                                                                                                                                                            |g1       |[{p1, 1.0}, {p1, 1.1}, {p1, 1.2}, {p1, 1.3}, {p1, 0.2}, {p1, 1.3}, {p2, 0.8}, {p2, 1.1}, {p2, 1.5}, {p2, 1.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.0}, {p3, 1.4}, {p3, 1.6}, {p3, 2.3}, {p3, 2.0}, {p3, 1.3}, {p3, 2.0}, {p3, 3.3}]                                                                                                                                                                                                                            |
+-------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

root
 |-- gene_id: string (nullable = true)
 |-- values: array (nullable = false)
 |    |-- element: struct (containsNull = false)
 |    |    |-- patient_id: string (nullable = true)
 |    |    |-- biomarker_value: double (nullable = true)
 |-- gene_id_2: string (nullable = true)
 |-- values_2: array (nullable = false)
 |    |-- element: struct (containsNull = false)
 |    |    |-- patient_id: string (nullable = true)
 |    |    |-- biomarker_value: double (nullable = true)

filtered =  DataFrame[gene_id: string, values: array<struct<patient_id:string,biomarker_value:double>>, gene_id_2: string, values_2: array<struct<patient_id:string,biomarker_value:double>>]
filtered.count() =  6
+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|gene_id|values                                                                                                                                                                                                                                                                                                                         |gene_id_2|values_2                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|g2     |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 0.6}, {p2, 0.1}, {p2, 0.5}, {p2, 3.0}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                  |g4       |[{p1, 1.2}, {p1, 1.3}, {p1, 1.0}, {p1, 1.2}, {p1, 2.6}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.4}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.6}, {p2, 3.3}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p3, 1.0}, {p3, 0.8}, {p3, 0.3}]|
|g2     |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 0.6}, {p2, 0.1}, {p2, 0.5}, {p2, 3.0}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                  |g3       |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                         |
|g3     |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]|g4       |[{p1, 1.2}, {p1, 1.3}, {p1, 1.0}, {p1, 1.2}, {p1, 2.6}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.4}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.6}, {p2, 3.3}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p3, 1.0}, {p3, 0.8}, {p3, 0.3}]|
|g1     |[{p1, 1.0}, {p1, 1.1}, {p1, 1.2}, {p1, 1.3}, {p1, 0.2}, {p1, 1.3}, {p2, 0.8}, {p2, 1.1}, {p2, 1.5}, {p2, 1.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.0}, {p3, 1.4}, {p3, 1.6}, {p3, 2.3}, {p3, 2.0}, {p3, 1.3}, {p3, 2.0}, {p3, 3.3}]                                                                                                   |g4       |[{p1, 1.2}, {p1, 1.3}, {p1, 1.0}, {p1, 1.2}, {p1, 2.6}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.4}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.6}, {p2, 3.3}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p3, 1.0}, {p3, 0.8}, {p3, 0.3}]|
|g1     |[{p1, 1.0}, {p1, 1.1}, {p1, 1.2}, {p1, 1.3}, {p1, 0.2}, {p1, 1.3}, {p2, 0.8}, {p2, 1.1}, {p2, 1.5}, {p2, 1.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.0}, {p3, 1.4}, {p3, 1.6}, {p3, 2.3}, {p3, 2.0}, {p3, 1.3}, {p3, 2.0}, {p3, 3.3}]                                                                                                   |g2       |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 0.6}, {p2, 0.1}, {p2, 0.5}, {p2, 3.0}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                                                                                           |
|g1     |[{p1, 1.0}, {p1, 1.1}, {p1, 1.2}, {p1, 1.3}, {p1, 0.2}, {p1, 1.3}, {p2, 0.8}, {p2, 1.1}, {p2, 1.5}, {p2, 1.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.0}, {p3, 1.4}, {p3, 1.6}, {p3, 2.3}, {p3, 2.0}, {p3, 1.3}, {p3, 2.0}, {p3, 3.3}]                                                                                                   |g3       |[{p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.2}, {p1, 2.3}, {p1, 3.0}, {p1, 0.7}, {p1, 1.3}, {p1, 2.0}, {p1, 1.4}, {p2, 1.0}, {p2, 2.1}, {p2, 2.5}, {p2, 3.3}, {p2, 1.1}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}, {p2, 0.7}, {p3, 1.9}, {p3, 2.4}, {p3, 2.6}, {p3, 1.3}, {p3, 1.8}, {p3, 1.3}]                                                                                                                         |
+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

root
 |-- gene_id: string (nullable = true)
 |-- values: array (nullable = false)
 |    |-- element: struct (containsNull = false)
 |    |    |-- patient_id: string (nullable = true)
 |    |    |-- biomarker_value: double (nullable = true)
 |-- gene_id_2: string (nullable = true)
 |-- values_2: array (nullable = false)
 |    |-- element: struct (containsNull = false)
 |    |    |-- patient_id: string (nullable = true)
 |    |    |-- biomarker_value: double (nullable = true)

corr =  DataFrame[gene_id: string, gene_id_2: string, pearson: map<string,float>, spearman: map<string,float>]
corr.count() =  6
+-------+---------+-------------------------------------------------+------------------------------------------+
|gene_id|gene_id_2|pearson                                          |spearman                                  |
+-------+---------+-------------------------------------------------+------------------------------------------+
|g2     |g4       |{correlation -> -0.5830989, pvalue -> 0.60368}   |{correlation -> -0.5, pvalue -> 0.6666667}|
|g2     |g3       |{correlation -> 0.99274606, pvalue -> 0.07672638}|{correlation -> 1.0, pvalue -> 0.0}       |
|g3     |g4       |{correlation -> -0.4811942, pvalue -> 0.6804064} |{correlation -> -0.5, pvalue -> 0.6666667}|
|g1     |g4       |{correlation -> -0.38144317, pvalue -> 0.7508544}|{correlation -> 0.5, pvalue -> 0.6666667} |
|g1     |g2       |{correlation -> 0.9733965, pvalue -> 0.14717439} |{correlation -> 0.5, pvalue -> 0.6666667} |
|g1     |g3       |{correlation -> 0.9938835, pvalue -> 0.07044801} |{correlation -> 0.5, pvalue -> 0.6666667} |
+-------+---------+-------------------------------------------------+------------------------------------------+

root
 |-- gene_id: string (nullable = true)
 |-- gene_id_2: string (nullable = true)
 |-- pearson: map (nullable = true)
 |    |-- key: string
 |    |-- value: float (valueContainsNull = true)
 |-- spearman: map (nullable = true)
 |    |-- key: string
 |    |-- value: float (valueContainsNull = true)

